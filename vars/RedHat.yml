---
epel_repo_name: 'epel'
epel_repo_url: 'http://mirrors.aliyun.com/epel/{{ ansible_distribution_major_version }}/$basearch/'

rsyslog_repo_name: 'rsyslog'
rsyslog_repo_url: 'http://rpms.adiscon.com/v8-stable/epel-$releasever/$basearch'
rsyslog_packages: 'rsyslog'

exporter_repo_name: 'prometheus'
exporter_repo_url: "http://cache.omygods.com/prometheus-rpm/release/el/{{ansible_distribution_version.split('.')[0]}}/$basearch"
exporter_software: 'node_exporter'

ossec_repo_name: 'wazuh'
ossec_repo_url: 'http://cache.omygods.com/wazuh/{{ ossec_version.split(".")[0] }}.x/yum'

osquery_repo_name: 'osquery'
osquery_repo_url: 'http://cache.omygods.com/osquery'

ossec_agent_dependent_packages:
  - 'expect'
  - 'python-docker'
  - 'openscap-scanner'
  - 'openssl'
  - 'osquery'

ossec_agent_packages:
  - 'wazuh-agent-{{ ossec_version }}*'

disable_service_RedHat_6: # 版本6不需要的服务。
  - 'abrt-ccpp'
  - 'abrtd'
  - 'abrt-oops'
  - 'acpid'
  - 'cpuspeed'
  - 'ip6tables'
  - 'iscsi'
  - 'iscsid'
  - 'mdmonitor'
  - 'messagebus'
  - 'netfs'
  - 'postfix'
  - 'sysstat'
enabled_service_RedHat_6: # 版本6需要的服务。
  - 'iptables'
  - 'nscd'
  - 'ntpd'
  - 'rsyslog'
disable_service_RedHat_7: # 版本7不需要的服务。
  - 'abrt-ccpp.service'
  - 'abrtd.service'
  - 'abrt-oops.service'
  - 'abrt-vmcore.service'
  - 'abrt-xorg.service'
  - 'chronyd.service'
  - 'dmraid-activation.service'
  - 'libstoragemgmt.service'
  - 'mdmonitor.service'
  - 'NetworkManager.service'
  - 'postfix.service'
  - 'rpcbind.service'
  - 'rpcbind.socket'
  - 'smartd.service'
  - 'sysstat.service'
  - 'systemd-readahead-collect.service'
  - 'systemd-readahead-drop.service'
  - 'systemd-readahead-replay.service'
  - 'tuned.service'
  - 'vdo.service'
enabled_service_RedHat_7: # 版本7需要的服务。
  - 'firewalld.service'
  - 'ntpd.service'
  - 'nscd.service'
  - 'rsyslog.service'

unload_module_RedHat: # 不需要的模块。
  - 'cramfs'
  - 'floppy'
  - 'freevxfs'
  - 'jffs2'
  - 'hfs'
  - 'hfsplus'
  - 'udf'
#  - 'vfat' # for EFI
  - 'dccp'
  - 'rds'
  - 'squashfs'
  - 'tipc'

base_packages_RedHat_7: # 版本7需要安装的系统组件。
  - '@Base'
  - 'aide'
  - 'audispd-plugins'
  - 'bind-utils'
  - 'deltarpm'
  - 'dstat'
  - 'htop'
  - 'libselinux-utils'
  - 'lvm2'
  - 'iftop'
  - 'iotop'
  - 'ksh'
  - 'moreutils'
  - 'nethogs'
  - 'net-tools'
  - 'nmap'
  - 'nmon'
  - 'nscd'
  - 'ntp'
  - 'numactl'
  - 'policycoreutils-python'
  - 'procmail'
  - 'python2-jmespath'
  - 'strace'
  - 'tcpdump'
  - 'tcpflow'
  - 'telnet'
  - 'traceroute'
  - 'tree'
  - 'xfsprogs'

remove_packages_RedHat_7: # 版本7需要删除的系统组件。
  - 'aic94xx-firmware'
  - 'alsa-firmware'
  - 'alsa-tools-firmware'
  - 'ivtv-firmware'
  - 'iwl1000-firmware'
  - 'iwl100-firmware'
  - 'iwl105-firmware'
  - 'iwl135-firmware'
  - 'iwl2000-firmware'
  - 'iwl2030-firmware'
  - 'iwl3160-firmware'
  - 'iwl3945-firmware'
  - 'iwl4965-firmware'
  - 'iwl5000-firmware'
  - 'iwl5150-firmware'
  - 'iwl6000-firmware'
  - 'iwl6000g2a-firmware'
  - 'iwl6000g2b-firmware'
  - 'iwl6050-firmware'
  - 'iwl7260-firmware'
  - 'iwl7265-firmware'
  - 'microcode_ctl'

base_packages_RedHat_6: # 版本6需要安装的系统组件。
  - '@Base'
  - 'aide'
  - 'audispd-plugins'
  - 'bind-utils'
  - 'deltarpm'
  - 'dstat'
  - 'htop'
  - 'libselinux-python'
  - 'ifstatus'
  - 'iftop'
  - 'iotop'
  - 'irqbalance'
  - 'ksh'
  - 'moreutils'
  - 'nethogs'
  - 'nmap'
  - 'nmon'
  - 'nscd'
  - 'ntp'
  - 'policycoreutils-python'
  - 'procmail'
  - 'python-simplejson'
  - 'python2-jmespath'
  - 'tcpdump'
  - 'telnet'
  - 'traceroute'
  - 'tree'
  - 'vim-enhanced'
  - 'xfsprogs'

remove_packages_RedHat_6: # 版本6需要删除的系统组件。
  - 'microcode_ctl'

os_linux_protected_file: # 需要限制权限的系统文件。
  - '/boot/grub2/grub.cfg'
  - '/etc/cron.d'
  - '/etc/cron.daily'
  - '/etc/cron.hourly'
  - '/etc/cron.monthly'
  - '/etc/cron.weekly'
  - '/etc/crontab'
